/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/GUIForms/JPanel.java to edit this template
 */
package ui.Admin;

import javax.swing.*;

import com.mongodb.client.MongoCollection;
import com.mongodb.client.MongoDatabase;
import database.Connection;

import java.awt.CardLayout;

import model.Business.Business;
import org.bson.Document;

public class AddSupplierJPanel extends javax.swing.JPanel {
    /**
     * Creates new form addMedicalEquipmentJPanel
     */
    JPanel AdminLayout;
    Business business;
    MongoDatabase database;
    MongoCollection<Document> supplierCollection;
    MongoCollection<Document> userCollection;

    public AddSupplierJPanel(JPanel cardSequencePanel, MongoDatabase databases, Business business) {
        initComponents();
        this.AdminLayout = cardSequencePanel;
        this.business = business;
        this.database = new Connection().connectToDatabase();
        supplierCollection = database.getCollection("Supplier");
        userCollection = database.getCollection("UserLogin");


    }

    /**
     * This method is called from within the constructor to initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is always
     * regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        addMedicalEquipmentList = new javax.swing.JPanel();
        lblAddMedicalEquipmentTitle = new javax.swing.JLabel();
        txtEquipmentSupplierName = new javax.swing.JTextField();
        txtSupplierContact = new javax.swing.JTextField();
        lblSupplierProvidedEquipmentName = new javax.swing.JLabel();
        lblSupplierName = new javax.swing.JLabel();
        btnAddNewSupplier = new javax.swing.JButton();
        txtSupplierAddress = new javax.swing.JTextField();
        lblSupplierContact1 = new javax.swing.JLabel();
        btnBack = new javax.swing.JButton();
        lblCourseInstructor = new javax.swing.JLabel();
        txtHospitalManagerName = new javax.swing.JTextField();
        lblTrainingCentreManagerPassword = new javax.swing.JLabel();
        txtHospitalManagerPassword = new javax.swing.JTextField();
        lblSupplierContact2 = new javax.swing.JLabel();
        txtSupplierContact1 = new javax.swing.JTextField();

        setLayout(new java.awt.CardLayout());

        lblAddMedicalEquipmentTitle.setFont(new java.awt.Font("Trebuchet MS", 0, 18)); // NOI18N
        lblAddMedicalEquipmentTitle.setHorizontalAlignment(javax.swing.SwingConstants.CENTER);
        lblAddMedicalEquipmentTitle.setText("ADD EQUIPMENT SUPPLIER DETAILS");
        lblAddMedicalEquipmentTitle.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));

        txtEquipmentSupplierName.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        txtEquipmentSupplierName.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtEquipmentSupplierNameActionPerformed(evt);
            }
        });

        txtSupplierContact.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        txtSupplierContact.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtSupplierContactActionPerformed(evt);
            }
        });

        lblSupplierProvidedEquipmentName.setFont(new java.awt.Font("Trebuchet MS", 0, 18)); // NOI18N
        lblSupplierProvidedEquipmentName.setHorizontalAlignment(javax.swing.SwingConstants.TRAILING);
        lblSupplierProvidedEquipmentName.setText("Supplier Address :");

        lblSupplierName.setFont(new java.awt.Font("Trebuchet MS", 0, 18)); // NOI18N
        lblSupplierName.setHorizontalAlignment(javax.swing.SwingConstants.TRAILING);
        lblSupplierName.setText("Supplier Name :");

        btnAddNewSupplier.setFont(new java.awt.Font("Trebuchet MS", 0, 18)); // NOI18N
        btnAddNewSupplier.setText("Add Supplier");
        btnAddNewSupplier.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnAddNewSupplierActionPerformed(evt);
            }
        });

        txtSupplierAddress.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        txtSupplierAddress.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtSupplierAddressActionPerformed(evt);
            }
        });

        lblSupplierContact1.setFont(new java.awt.Font("Trebuchet MS", 0, 18)); // NOI18N
        lblSupplierContact1.setHorizontalAlignment(javax.swing.SwingConstants.TRAILING);
        lblSupplierContact1.setText("Supplier Contact :");

        btnBack.setFont(new java.awt.Font("Trebuchet MS", 0, 18)); // NOI18N
        btnBack.setText("Back");
        btnBack.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                btnBackActionPerformed(evt);
            }
        });

        lblCourseInstructor.setFont(new java.awt.Font("Trebuchet MS", 0, 18)); // NOI18N
        lblCourseInstructor.setText("Manager Name :");

        lblTrainingCentreManagerPassword.setFont(new java.awt.Font("Trebuchet MS", 0, 18)); // NOI18N
        lblTrainingCentreManagerPassword.setText("Manager Password :");

        lblSupplierContact2.setFont(new java.awt.Font("Trebuchet MS", 0, 18)); // NOI18N
        lblSupplierContact2.setHorizontalAlignment(javax.swing.SwingConstants.TRAILING);
        lblSupplierContact2.setText("Supplier Email :");

        txtSupplierContact1.setHorizontalAlignment(javax.swing.JTextField.CENTER);
        txtSupplierContact1.addActionListener(new java.awt.event.ActionListener() {
            public void actionPerformed(java.awt.event.ActionEvent evt) {
                txtSupplierContact1ActionPerformed(evt);
            }
        });

        javax.swing.GroupLayout addMedicalEquipmentListLayout = new javax.swing.GroupLayout(addMedicalEquipmentList);
        addMedicalEquipmentList.setLayout(addMedicalEquipmentListLayout);
        addMedicalEquipmentListLayout.setHorizontalGroup(
                addMedicalEquipmentListLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(addMedicalEquipmentListLayout.createSequentialGroup()
                                .addGroup(addMedicalEquipmentListLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addGroup(addMedicalEquipmentListLayout.createSequentialGroup()
                                                .addGap(110, 110, 110)
                                                .addGroup(addMedicalEquipmentListLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                        .addComponent(lblAddMedicalEquipmentTitle, javax.swing.GroupLayout.PREFERRED_SIZE, 455, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                        .addGroup(addMedicalEquipmentListLayout.createSequentialGroup()
                                                                .addGroup(addMedicalEquipmentListLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                                                        .addComponent(lblSupplierProvidedEquipmentName)
                                                                        .addComponent(lblSupplierName)
                                                                        .addComponent(lblSupplierContact1))
                                                                .addGap(18, 18, 18)
                                                                .addGroup(addMedicalEquipmentListLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                                        .addComponent(btnAddNewSupplier, javax.swing.GroupLayout.PREFERRED_SIZE, 121, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                                        .addComponent(txtEquipmentSupplierName, javax.swing.GroupLayout.DEFAULT_SIZE, 143, Short.MAX_VALUE)
                                                                        .addComponent(txtSupplierAddress, javax.swing.GroupLayout.DEFAULT_SIZE, 143, Short.MAX_VALUE)
                                                                        .addComponent(txtSupplierContact)))))
                                        .addGroup(addMedicalEquipmentListLayout.createSequentialGroup()
                                                .addGap(26, 26, 26)
                                                .addComponent(btnBack, javax.swing.GroupLayout.PREFERRED_SIZE, 100, javax.swing.GroupLayout.PREFERRED_SIZE))
                                        .addGroup(addMedicalEquipmentListLayout.createSequentialGroup()
                                                .addGap(96, 96, 96)
                                                .addGroup(addMedicalEquipmentListLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.TRAILING)
                                                        .addComponent(lblTrainingCentreManagerPassword)
                                                        .addComponent(lblCourseInstructor))
                                                .addGap(18, 18, 18)
                                                .addGroup(addMedicalEquipmentListLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING, false)
                                                        .addComponent(txtHospitalManagerName, javax.swing.GroupLayout.DEFAULT_SIZE, 253, Short.MAX_VALUE)
                                                        .addComponent(txtHospitalManagerPassword))))
                                .addContainerGap(144, Short.MAX_VALUE))
                        .addGroup(addMedicalEquipmentListLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addGroup(addMedicalEquipmentListLayout.createSequentialGroup()
                                        .addGap(120, 120, 120)
                                        .addComponent(lblSupplierContact2)
                                        .addGap(18, 18, 18)
                                        .addComponent(txtSupplierContact1)
                                        .addGap(179, 179, 179)))
        );

        addMedicalEquipmentListLayout.linkSize(javax.swing.SwingConstants.HORIZONTAL, new java.awt.Component[]{btnAddNewSupplier, txtEquipmentSupplierName, txtHospitalManagerName, txtSupplierAddress, txtSupplierContact});

        addMedicalEquipmentListLayout.setVerticalGroup(
                addMedicalEquipmentListLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                        .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, addMedicalEquipmentListLayout.createSequentialGroup()
                                .addGap(20, 20, 20)
                                .addComponent(btnBack, javax.swing.GroupLayout.PREFERRED_SIZE, 40, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.RELATED, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                                .addComponent(lblAddMedicalEquipmentTitle)
                                .addGap(59, 59, 59)
                                .addGroup(addMedicalEquipmentListLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addGroup(addMedicalEquipmentListLayout.createSequentialGroup()
                                                .addComponent(txtEquipmentSupplierName, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                                .addComponent(txtSupplierAddress, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                                        .addGroup(addMedicalEquipmentListLayout.createSequentialGroup()
                                                .addComponent(lblSupplierName)
                                                .addPreferredGap(javax.swing.LayoutStyle.ComponentPlacement.UNRELATED)
                                                .addComponent(lblSupplierProvidedEquipmentName)))
                                .addGap(18, 18, 18)
                                .addGroup(addMedicalEquipmentListLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                        .addComponent(txtSupplierContact, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                        .addComponent(lblSupplierContact1))
                                .addGap(50, 50, 50)
                                .addGroup(addMedicalEquipmentListLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                        .addComponent(lblCourseInstructor)
                                        .addComponent(txtHospitalManagerName, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(18, 18, 18)
                                .addGroup(addMedicalEquipmentListLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.BASELINE)
                                        .addComponent(lblTrainingCentreManagerPassword)
                                        .addComponent(txtHospitalManagerPassword, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE))
                                .addGap(32, 32, 32)
                                .addComponent(btnAddNewSupplier, javax.swing.GroupLayout.PREFERRED_SIZE, 49, javax.swing.GroupLayout.PREFERRED_SIZE)
                                .addGap(42, 42, 42))
                        .addGroup(addMedicalEquipmentListLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, addMedicalEquipmentListLayout.createSequentialGroup()
                                        .addContainerGap(259, Short.MAX_VALUE)
                                        .addGroup(addMedicalEquipmentListLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                                                .addComponent(txtSupplierContact1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                                                .addComponent(lblSupplierContact2))
                                        .addGap(204, 204, 204)))
        );

        addMedicalEquipmentListLayout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[]{lblSupplierName, lblSupplierProvidedEquipmentName});

        addMedicalEquipmentListLayout.linkSize(javax.swing.SwingConstants.VERTICAL, new java.awt.Component[]{txtEquipmentSupplierName, txtSupplierAddress, txtSupplierContact});

        add(addMedicalEquipmentList, "card2");
    }// </editor-fold>//GEN-END:initComponents

    private void txtSupplierAddressActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtSupplierAddressActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtSupplierAddressActionPerformed

    private void btnAddNewSupplierActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnAddNewSupplierActionPerformed
        // TODO add your handling code here:
        String supplierName = txtEquipmentSupplierName.getText();
        String supplierAddress = txtSupplierAddress.getText();
        String supplierContact = txtSupplierContact.getText();
        String supplierEmail = txtSupplierContact1.getText();
        String managerName = txtHospitalManagerName.getText();
        String managerPassword = txtHospitalManagerPassword.getText();

        Document user = new Document("username", supplierName)
                .append("password", managerPassword)
                .append("name", managerName);

//        check if the user already exists
        Document userExist = userCollection.find(new Document("username", supplierName)).first();
        if (userExist != null) {
            System.out.println("User already exists");
            JOptionPane.showMessageDialog(null, "User already exists");
            return;
        }
        userCollection.insertOne(user);
        Document userDoc = userCollection.find(new Document("username", supplierName)).first();

        Document supplier = new Document("supplierName", supplierName)
                .append("supplierAddress", supplierAddress)
                .append("supplierContact", supplierContact)
                .append("supplierEmail", supplierEmail)
                .append("supplierAdminId", userDoc.getObjectId("_id"))
                .append("organizationType", "Supplier");

        supplierCollection.insertOne(supplier);
        JOptionPane.showMessageDialog(null, "Supplier added successfully");
        btnBackActionPerformed(evt);


    }//GEN-LAST:event_btnAddNewSupplierActionPerformed

    private void txtSupplierContactActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtSupplierContactActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtSupplierContactActionPerformed

    private void txtEquipmentSupplierNameActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtEquipmentSupplierNameActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtEquipmentSupplierNameActionPerformed

    private void btnBackActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_btnBackActionPerformed
        // TODO add your handling code here:
        FoodProcessorAdminJPanel medicalEquipmentAdminJPanel = new FoodProcessorAdminJPanel(AdminLayout, database, business);
        AdminLayout.add("MedicalEquipmentAdminJPanel", medicalEquipmentAdminJPanel);
        CardLayout layout = (CardLayout) AdminLayout.getLayout();
        layout.next(AdminLayout);
    }//GEN-LAST:event_btnBackActionPerformed

    private void txtSupplierContact1ActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_txtSupplierContact1ActionPerformed
        // TODO add your handling code here:
    }//GEN-LAST:event_txtSupplierContact1ActionPerformed


    // Variables declaration - do not modify//GEN-BEGIN:variables
    private javax.swing.JPanel addMedicalEquipmentList;
    private javax.swing.JButton btnAddNewSupplier;
    private javax.swing.JButton btnBack;
    private javax.swing.JLabel lblAddMedicalEquipmentTitle;
    private javax.swing.JLabel lblCourseInstructor;
    private javax.swing.JLabel lblSupplierContact1;
    private javax.swing.JLabel lblSupplierContact2;
    private javax.swing.JLabel lblSupplierName;
    private javax.swing.JLabel lblSupplierProvidedEquipmentName;
    private javax.swing.JLabel lblTrainingCentreManagerPassword;
    private javax.swing.JTextField txtEquipmentSupplierName;
    private javax.swing.JTextField txtHospitalManagerName;
    private javax.swing.JTextField txtHospitalManagerPassword;
    private javax.swing.JTextField txtSupplierAddress;
    private javax.swing.JTextField txtSupplierContact;
    private javax.swing.JTextField txtSupplierContact1;
    // End of variables declaration//GEN-END:variables
}
